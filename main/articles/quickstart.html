<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SimulationEngineMSM: Quickstart • SimulationEngineMSM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SimulationEngineMSM: Quickstart">
<meta property="og:description" content="SimulationEngineMSM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimulationEngineMSM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9013</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/quickstart.html">SimulationEngineMSM: Quickstart</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" href="https://insightsengineering.github.io/SimulationEngineMSM/main">main</a> </div></li>
<!-- end dropdown for versions -->
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/insightsengineering/SimulationEngineMSM" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SimulationEngineMSM: Quickstart</h1>
                        <h4 data-toc-skip class="author">Alexandra
Niessl</h4>
            
            <h4 data-toc-skip class="date">2022-07-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/SimulationEngineMSM/blob/HEAD/vignettes/quickstart.Rmd" class="external-link"><code>vignettes/quickstart.Rmd</code></a></small>
      <div class="hidden name"><code>quickstart.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The purpose of this vignette is to explain the use of
<code><a href="../reference/getClinicalTrials.html">getClinicalTrials()</a></code>, the core function of this package.
<code><a href="../reference/getClinicalTrials.html">getClinicalTrials()</a></code> can be used to simulate a large number
of clinical trials with endpoints overall survival (OS) and
progression-free survival (PFS). The underlying model is a survival
multistate model with an initial state, an intermediate
<code>progression</code> state and an absorbing <code>death</code>
state. The multistate model approach has the advantage of naturally
accounting for the correlation between the OS and PFS endpoints <span class="citation">(Meller, Beyersmann, and Rufibach 2019)</span>. OS is
defined as the time to reach the absorbing state death and PFS is
defined as the time to reach the absorbing state <code>death</code> or
the intermediate state <code>progression</code>, whichever occurs first.
Figure 1 shows the multistate model with the corresponding transition
hazards. To get started quickly, we show a simple and quick example of a
clinical trial simulation.</p>
<div class="figure">
<img src="quickstart_files/figure-html/unnamed-chunk-1-1.png" alt="Figure 1 - Multistate model with indermediate state progession and absorbing state death" width="60%"><p class="caption">
Figure 1 - Multistate model with indermediate state progession and
absorbing state death
</p>
</div>
</div>
<div class="section level2">
<h2 id="simulation-specifications">Simulation Specifications<a class="anchor" aria-label="anchor" href="#simulation-specifications"></a>
</h2>
<p><code><a href="../reference/getClinicalTrials.html">getClinicalTrials()</a></code> simulates trials with an arbitrary
number of treatment arms. In general, the argument specifications were
tried to be similar to the R-package Rpact <span class="citation">(Wassmer and Pahlke 2021)</span> in order to be more
user-friendly. For illustration, we consider a trial with two arms. The
number of patients per trial must be specified. In our example
simulation there are 30 patients in the first treatment arm and 60 in
the second treatment arm:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span><span class="op">)</span></span></code></pre></div>
<p>The transition parameters describing the transition hazards per
treatment arm must be passed as a list to
<code><a href="../reference/getClinicalTrials.html">getClinicalTrials()</a></code>. The class
<code>TransitionParameters</code> contains the elements
<code>hazards</code>, <code>intervals</code>, <code>weibull_rates</code>
and <code>family</code> which allow to describe transition hazards
leading to exponential, piecewise exponential or Weibull distributed
survival times. There are some helper functions in the
<code>SimulationEngineMSM</code> package to create the appropriate
transition parameters for the desired distribution. -
<code><a href="../reference/exponential_transition.html">exponential_transition()</a></code>: creates a list with class
<code>TransitionParameters</code> containing hazards, time intervals and
Weibull rates for exponential event times in an illness-death model. -
<code><a href="../reference/piecewise_exponential.html">piecewise_exponential()</a></code>: creates a list with class
<code>TransitionParameters</code> containing hazards, time intervals and
Weibull rates for piecewise exponential event times in an illness-death
model. - <code><a href="../reference/weibull_transition.html">weibull_transition()</a></code>: creates a list with class
<code>TransitionParameters</code> containing hazards, time intervals and
Weibull rates for Weibull distributed event times in an illness-death
model.</p>
<p>In our example we consider constant hazard rates, i.e. exponential
distributed event times.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/insightsengineering/SimulationEngineMSM/" class="external-link">SimulationEngineMSM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">transitionGroup1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exponential_transition.html">exponential_transition</a></span><span class="op">(</span>h01 <span class="op">=</span> <span class="fl">1.2</span>, h02 <span class="op">=</span> <span class="fl">1.5</span>, h12 <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">transitionGroup1</span><span class="op">$</span><span class="va">hazards</span><span class="op">)</span></span>
<span><span class="co">#&gt; $h01</span></span>
<span><span class="co">#&gt; [1] 1.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h02</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h12</span></span>
<span><span class="co">#&gt; [1] 1.6</span></span>
<span><span class="va">transitionGroup2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exponential_transition.html">exponential_transition</a></span><span class="op">(</span>h01 <span class="op">=</span> <span class="fl">1</span>, h02 <span class="op">=</span> <span class="fl">1.3</span>, h12 <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">transitionGroup2</span><span class="op">$</span><span class="va">hazards</span><span class="op">)</span></span>
<span><span class="co">#&gt; $h01</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h02</span></span>
<span><span class="co">#&gt; [1] 1.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h12</span></span>
<span><span class="co">#&gt; [1] 1.7</span></span>
<span><span class="va">transitionbyArm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">transitionGroup1</span>, <span class="va">transitionGroup2</span><span class="op">)</span></span></code></pre></div>
<p>The specification for random patient dropouts can be passed directly
to <code><a href="../reference/getClinicalTrials.html">getClinicalTrials()</a></code>. A list with elements
<code>rate</code> and <code>time</code> specifies the drop-out
probability. Random censoring times are generated using the exponential
distribution. <code>dropout$rate</code> specifies the drop-out
probability per <code>dropout$time</code> time units. If
<code>dropout$rate</code> is equal to 0, then no censoring due to
dropout is applied. In our example we expect that 10% of the patients
drop-out within 12 months per treatment group (we take month as the time
unit of our trial), thus we specify:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.1</span>, time <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<p>There are two time-scales that we need to consider when simulating
multistate data. The individual time scale with start in the initial
state at time 0 and the study time scale, which matches the individual
time scale only if the study start time (e.g. randomization date) is the
same time in calendar time for all patients. It can also be specified
that patients enter the study in a staggered manner. Uniformly
distributed random variables are used to generate staggered study entry
times. There are two possibilities for the specification: Either, the
length of the accrual period is specified, e.g. 12 month, in which case
the staggered entry times are generated in each treatment group using
random variables <span class="math inline">\(U ~Unif(0, 12)\)</span>.
Or, it is specified how many patients are recruited per time unit in
each treatment group. Thus, if 10 patients are recruited per month, then
the staggered entry times are generated using random variables <span class="math inline">\(U ~Unif(0, 30/10)\)</span>. A list
<code>accural</code> with elements <code>accrualParam</code> and
<code>accrualValue</code> is passed to <code><a href="../reference/getClinicalTrials.html">getClinicalTrials()</a></code>
describing the accrual intensity. For <code>accrualParam</code> equal
time, <code>accrualValue</code>describes the length of the accrual
period. For <code>accrualParam</code> equal intensity, it describes the
number of patients recruited per time unit. If <code>accrualValue</code>
is equal to 0, all patients start at the same calender time in the
initial state.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first example</span></span>
<span><span class="va">accrual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>param <span class="op">=</span> <span class="st">"intensity"</span>, value <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co"># second example</span></span>
<span><span class="va">accrual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>param <span class="op">=</span> <span class="st">"intensity"</span>, value <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a>
</h2>
<p>We now simulate 100 (<code>nRep</code>=100) clinical trials with the
parameters described and specified above. There are two options for how
the output data is presented, one row per patient or one row per
transition and patient. Let’s take a look at both.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simStudies1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getClinicalTrials.html">getClinicalTrials</a></span><span class="op">(</span></span>
<span>  nRep <span class="op">=</span> <span class="fl">100</span>, nPat <span class="op">=</span> <span class="va">nPat</span>, seed <span class="op">=</span> <span class="fl">1234</span>, datType <span class="op">=</span> <span class="st">"1rowTransition"</span>,</span>
<span>  transitionByArm <span class="op">=</span> <span class="va">transitionbyArm</span>, dropout <span class="op">=</span> <span class="va">dropout</span>,</span>
<span>  accrual <span class="op">=</span> <span class="va">accrual</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">simStudies2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getClinicalTrials.html">getClinicalTrials</a></span><span class="op">(</span></span>
<span>  nRep <span class="op">=</span> <span class="fl">100</span>, nPat <span class="op">=</span> <span class="va">nPat</span>, seed <span class="op">=</span> <span class="fl">1234</span>, datType <span class="op">=</span> <span class="st">"1rowPatient"</span>,</span>
<span>  transitionByArm <span class="op">=</span> <span class="va">transitionbyArm</span>, dropout <span class="op">=</span> <span class="va">dropout</span>,</span>
<span>  accrual <span class="op">=</span> <span class="va">accrual</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="output-data">Output Data<a class="anchor" aria-label="anchor" href="#output-data"></a>
</h2>
<p>We get as output a list with <code>nRep</code> elements, each
containing a data set of a single simulated trial.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simStudies1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id from to     entry       exit entryAct   exitAct    censAct trt</span></span>
<span><span class="co">#&gt; 1  1    0  2 0.0000000 0.46787743 1.234711  1.702588 286.171654   1</span></span>
<span><span class="co">#&gt; 2  2    0  2 0.0000000 0.26010392 7.971605  8.231709  36.076123   1</span></span>
<span><span class="co">#&gt; 3  3    0  2 0.0000000 0.06150124 7.442772  7.504273   8.192422   1</span></span>
<span><span class="co">#&gt; 4  4    0  1 0.0000000 0.25964639 9.159742  9.419389 207.649214   1</span></span>
<span><span class="co">#&gt; 5  4    1  2 0.2596464 2.13580247 9.419389 11.295545 207.649214   1</span></span>
<span><span class="co">#&gt; 6  5    0  2 0.0000000 0.25227459 9.945982 10.198257  54.044011   1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simStudies2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id trt    PFStime CensoredPFS PFSevent     OStime CensoredOS OSevent</span></span>
<span><span class="co">#&gt; 1  1   1 0.46787743           0        1 0.46787743          0       1</span></span>
<span><span class="co">#&gt; 2  2   1 0.26010392           0        1 0.26010392          0       1</span></span>
<span><span class="co">#&gt; 3  3   1 0.06150124           0        1 0.06150124          0       1</span></span>
<span><span class="co">#&gt; 4  4   1 0.25964639           0        1 2.13580247          0       1</span></span>
<span><span class="co">#&gt; 5  5   1 0.25227459           0        1 0.25227459          0       1</span></span>
<span><span class="co">#&gt;   recruitTime OStimeCal PFStimeCal</span></span>
<span><span class="co">#&gt; 1    1.234711  1.702588   1.702588</span></span>
<span><span class="co">#&gt; 2    7.971605  8.231709   8.231709</span></span>
<span><span class="co">#&gt; 3    7.442772  7.504273   7.504273</span></span>
<span><span class="co">#&gt; 4    9.159742 11.295545   9.419389</span></span>
<span><span class="co">#&gt; 5    9.945982 10.198257  10.198257</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-meller2019joint" class="csl-entry">
Meller, Matthias, Jan Beyersmann, and Kaspar Rufibach. 2019.
<span>“Joint Modeling of Progression-Free and Overall Survival and
Computation of Correlation Measures.”</span> <em>Statistics in
Medicine</em> 38 (22): 4270–89.
</div>
<div id="ref-rpact" class="csl-entry">
Wassmer, Gernot, and Friedrich Pahlke. 2021. <em>Rpact: Confirmatory
Adaptive Clinical Trial Design and Analysis</em>. <a href="https://CRAN.R-project.org/package=rpact" class="external-link">https://CRAN.R-project.org/package=rpact</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexandra Niessl.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
